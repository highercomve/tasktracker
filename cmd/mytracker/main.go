package main

import (
	"go-tracker/internal/store"
	"go-tracker/internal/ui"

	"fyne.io/fyne/v2"
	"fyne.io/fyne/v2/app"
	"fyne.io/fyne/v2/container"
)

func main() {
	a := app.NewWithID("com.highercomve.task-tracker")
	// Simple red dot PNG
	// iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVR42mP8z8BQDwAEhQGAhKmMIQAAAABJRU5ErkJggg==
	var resourceIconPng = fyne.NewStaticResource("icon.png", []byte{
		0x89, 0x50, 0x4e, 0x47, 0x0d, 0x0a, 0x1a, 0x0a, 0x00, 0x00, 0x00, 0x0d, 0x49, 0x48, 0x44, 0x52,
		0x00, 0x00, 0x00, 0x01, 0x00, 0x00, 0x00, 0x01, 0x08, 0x06, 0x00, 0x00, 0x00, 0x1f, 0x15, 0xc4,
		0x89, 0x00, 0x00, 0x00, 0x0d, 0x49, 0x44, 0x41, 0x54, 0x78, 0xda, 0x63, 0xfc, 0xcf, 0xc0, 0x50,
		0x0f, 0x00, 0x04, 0x85, 0x01, 0x80, 0x84, 0xa9, 0x8c, 0x21, 0x00, 0x00, 0x00, 0x00, 0x49, 0x45,
		0x4e, 0x44, 0xae, 0x42, 0x60, 0x82,
	})

	a.SetIcon(resourceIconPng)
	w := a.NewWindow("Task Tracker")
	w.Resize(fyne.NewSize(400, 600))

	storage := store.NewStorage("data")
	dashboard := ui.NewDashboard(storage)
	reports := ui.NewReports(storage)

	tabs := container.NewAppTabs(
		container.NewTabItem("Tracker", dashboard.MakeUI()),
		container.NewTabItem("Reports", reports.MakeUI()),
	)

	w.SetContent(tabs)

	ui.SetupTray(a, w, resourceIconPng)

	w.ShowAndRun()
}
